# AlcoLook 아키텍처 다이어그램

## 전체 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              AlcoLook Android App                            │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           Presentation Layer                            │ │
│  │                                                                         │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │MainActivity │  │CameraScreen │  │PhotoUpload  │  │BatchAnalyzer│    │ │
│  │  │             │  │             │  │Screen       │  │Screen       │    │ │
│  │  │ • Navigation│  │ • Camera    │  │ • Gallery   │  │ • Batch     │    │ │
│  │  │ • Menu      │  │ • Preview   │  │ • Upload    │  │ • Statistics│    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                    UI Components                                    │ │ │
│  │  │                                                                     │ │ │
│  │  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐     │ │ │
│  │  │  │FaceDetection    │  │DrunkLevelDisplay│  │CameraPreview    │     │ │ │
│  │  │  │Overlay          │  │                 │  │                 │     │ │ │
│  │  │  │ • Face Boxes    │  │ • Percentage    │  │ • Real-time     │     │ │ │
│  │  │  │ • Color Coding  │  │ • Messages      │  │ • Permissions   │     │ │ │
│  │  │  │ • Multi-face    │  │ • Status        │  │ • Focus         │     │ │ │
│  │  │  └─────────────────┘  └─────────────────┘  └─────────────────┘     │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                            Business Layer                               │ │
│  │                                                                         │ │
│  │  ┌─────────────────────┐              ┌─────────────────────┐           │ │
│  │  │DrunkDetectionService│              │PhotoDrunkDetection  │           │ │
│  │  │                     │              │Service              │           │ │
│  │  │ • Real-time Analysis│              │ • Photo Analysis    │           │ │
│  │  │ • Face Tracking     │              │ • Multi-face Support│           │ │
│  │  │ • Continuous Mode   │              │ • Batch Processing  │           │ │
│  │  └─────────────────────┘              └─────────────────────┘           │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                      Core Algorithm Engine                          │ │ │
│  │  │                                                                     │ │ │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │ │ │
│  │  │  │Eye Analysis │  │Mouth Analysis│  │Emotion      │  │Facial       │ │ │ │
│  │  │  │             │  │             │  │Analysis     │  │Redness      │ │ │ │
│  │  │  │ • Open/Close│  │ • Open/Close│  │ • Confusion │  │ • Landmarks │ │ │ │
│  │  │  │ • Confidence│  │ • Confidence│  │ • Surprise  │  │ • Brightness│ │ │ │
│  │  │  │ • Scoring   │  │ • Scoring   │  │ • Disgust   │  │ • Estimation│ │ │ │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘ │ │ │
│  │  │                                                                     │ │ │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                  │ │ │
│  │  │  │Pose Analysis│  │Score        │  │Message      │                  │ │ │
│  │  │  │             │  │Calculation  │  │Generation   │                  │ │ │
│  │  │  │ • Roll Angle│  │ • Weighted  │  │ • Level     │                  │ │ │
│  │  │  │ • Pitch     │  │ • Amplified │  │ • Status    │                  │ │ │
│  │  │  │ • Yaw       │  │ • Normalized│  │ • Advice    │                  │ │ │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘                  │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                             Data Layer                                  │ │
│  │                                                                         │ │
│  │  ┌─────────────────────┐              ┌─────────────────────┐           │ │
│  │  │Image Processing     │              │Configuration        │           │ │
│  │  │                     │              │Management           │           │ │
│  │  │ • Bitmap Handling   │              │ • AWS Config       │           │ │
│  │  │ • JPEG Compression  │              │ • Test Mode        │           │ │
│  │  │ • ByteBuffer Conv.  │              │ • Credentials      │           │ │
│  │  └─────────────────────┘              └─────────────────────┘           │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                         Data Models                                 │ │ │
│  │  │                                                                     │ │ │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │ │ │
│  │  │  │FaceBox      │  │DrunkDetection│  │ImageAnalysis│  │TestResult   │ │ │ │
│  │  │  │             │  │Result       │  │Result       │  │             │ │ │ │
│  │  │  │ • Position  │  │ • DrunkLevel│  │ • FileName  │  │ • Expected  │ │ │ │
│  │  │  │ • Size      │  │ • Message   │  │ • DrunkLevel│  │ • Predicted │ │ │ │
│  │  │  │ • PersonId  │  │ • Faces     │  │ • HasError  │  │ • Accuracy  │ │ │ │
│  │  │  │ • DrunkPct  │  └─────────────┘  └─────────────┘  └─────────────┘ │ │ │
│  │  │  └─────────────┘                                                    │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        │ HTTPS/TLS
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              AWS Cloud Services                              │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                          Amazon Rekognition                             │ │
│  │                                                                         │ │
│  │  ┌─────────────────────┐              ┌─────────────────────┐           │ │
│  │  │DetectFaces API      │              │Face Analysis Engine │           │ │
│  │  │                     │              │                     │           │ │
│  │  │ • Image Input       │              │ • Machine Learning  │           │ │
│  │  │ • ALL Attributes    │              │ • Deep Neural Net   │           │ │
│  │  │ • JSON Response     │              │ • Computer Vision   │           │ │
│  │  └─────────────────────┘              └─────────────────────┘           │ │
│  │                                                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐ │ │
│  │  │                        Feature Detection                            │ │ │
│  │  │                                                                     │ │ │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │ │ │
│  │  │  │Facial       │  │Emotion      │  │Face Quality │  │Pose         │ │ │ │
│  │  │  │Landmarks    │  │Detection    │  │Assessment   │  │Estimation   │ │ │ │
│  │  │  │             │  │             │  │             │  │             │ │ │ │
│  │  │  │ • Eyes      │  │ • Happy     │  │ • Brightness│  │ • Roll      │ │ │ │
│  │  │  │ • Nose      │  │ • Sad       │  │ • Sharpness │  │ • Pitch     │ │ │ │
│  │  │  │ • Mouth     │  │ • Angry     │  │ • Confidence│  │ • Yaw       │ │ │ │
│  │  │  │ • Cheeks    │  │ • Confused  │  └─────────────┘  └─────────────┘ │ │ │
│  │  │  └─────────────┘  └─────────────┘                                   │ │ │
│  │  └─────────────────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                            AWS Security                                 │ │
│  │                                                                         │ │
│  │  ┌─────────────────────┐              ┌─────────────────────┐           │ │
│  │  │IAM Authentication   │              │Data Encryption      │           │ │
│  │  │                     │              │                     │           │ │
│  │  │ • Access Keys       │              │ • TLS 1.2+         │           │ │
│  │  │ • Temporary Tokens  │              │ • In-transit        │           │ │
│  │  │ • Role-based Access │              │ • At-rest           │           │ │
│  │  └─────────────────────┘              └─────────────────────┘           │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 컴포넌트 상호작용 다이어그램

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   User      │    │    UI       │    │  Business   │    │    AWS      │
│ Interface   │    │ Components  │    │   Logic     │    │ Rekognition │
└──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘
       │                  │                  │                  │
       │ 1. Take Photo    │                  │                  │
       │ ──────────────► │                  │                  │
       │                  │ 2. Process Image │                  │
       │                  │ ──────────────► │                  │
       │                  │                  │ 3. API Call     │
       │                  │                  │ ──────────────► │
       │                  │                  │                  │
       │                  │                  │ 4. Face Data    │
       │                  │                  │ ◄────────────── │
       │                  │ 5. Analyze      │                  │
       │                  │    Features     │                  │
       │                  │ ◄────────────── │                  │
       │ 6. Display       │                  │                  │
       │    Results       │                  │                  │
       │ ◄────────────── │                  │                  │
       │                  │                  │                  │
```

## 데이터 플로우 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Input Sources                                   │
│                                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │Camera       │  │Gallery      │  │File System  │  │Test Dataset │        │
│  │Stream       │  │Photos       │  │Images       │  │Images       │        │
│  └─────┬───────┘  └─────┬───────┘  └─────┬───────┘  └─────┬───────┘        │
└─────────┼─────────────────┼─────────────────┼─────────────────┼──────────────┘
          │                 │                 │                 │
          ▼                 ▼                 ▼                 ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Processing Pipeline                                │
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │
│  │Image        │    │Compression  │    │AWS API      │    │Feature      │   │
│  │Capture      │───►│& Format     │───►│Call         │───►│Extraction   │   │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘   │
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │
│  │Algorithm    │    │Score        │    │Result       │    │UI           │   │
│  │Processing   │───►│Calculation  │───►│Generation   │───►│Rendering    │   │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
                                                │
                                                ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Output Formats                                  │
│                                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │Face Boxes   │  │Drunk Level  │  │Status       │  │Log Data     │        │
│  │Overlay      │  │Percentage   │  │Messages     │  │Analytics    │        │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 모듈 의존성 다이어그램

```
                    ┌─────────────────────┐
                    │    MainActivity     │
                    │   (Entry Point)     │
                    └─────────┬───────────┘
                              │
              ┌───────────────┼───────────────┐
              │               │               │
              ▼               ▼               ▼
    ┌─────────────────┐ ┌─────────────┐ ┌─────────────┐
    │  CameraScreen   │ │PhotoUpload  │ │BatchAnalyzer│
    │                 │ │Screen       │ │Screen       │
    └─────────┬───────┘ └─────┬───────┘ └─────┬───────┘
              │               │               │
              └───────────────┼───────────────┘
                              │
                              ▼
                    ┌─────────────────────┐
                    │   Service Layer     │
                    │                     │
                    │ ┌─────────────────┐ │
                    │ │DrunkDetection   │ │
                    │ │Service          │ │
                    │ └─────────────────┘ │
                    │ ┌─────────────────┐ │
                    │ │PhotoDrunk       │ │
                    │ │DetectionService │ │
                    │ └─────────────────┘ │
                    └─────────┬───────────┘
                              │
                              ▼
                    ┌─────────────────────┐
                    │   Utility Layer     │
                    │                     │
                    │ ┌─────────────────┐ │
                    │ │AwsConfig        │ │
                    │ └─────────────────┘ │
                    │ ┌─────────────────┐ │
                    │ │FaceDetection    │ │
                    │ │Overlay          │ │
                    │ └─────────────────┘ │
                    └─────────┬───────────┘
                              │
                              ▼
                    ┌─────────────────────┐
                    │   External APIs     │
                    │                     │
                    │ ┌─────────────────┐ │
                    │ │AWS Rekognition  │ │
                    │ │API              │ │
                    │ └─────────────────┘ │
                    └─────────────────────┘
```

## 보안 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Security Layers                                │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        Application Security                             │ │
│  │                                                                         │ │
│  │  • Camera Permissions Management                                        │ │
│  │  • Local Data Protection                                                │ │
│  │  • Test Mode Isolation                                                  │ │
│  │  • Error Handling & Fallbacks                                           │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        Network Security                                 │ │
│  │                                                                         │ │
│  │  • HTTPS/TLS Encryption                                                 │ │
│  │  • Certificate Pinning                                                  │ │
│  │  • Request Signing                                                      │ │
│  │  • Rate Limiting                                                        │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                         AWS Security                                    │ │
│  │                                                                         │ │
│  │  • IAM Role-based Access                                                │ │
│  │  • Temporary Credentials                                                │ │
│  │  • API Key Management                                                   │ │
│  │  • Service-to-Service Auth                                              │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 성능 최적화 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Performance Optimizations                         │
│                                                                             │
│  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐   │
│  │Image Processing     │  │API Call             │  │UI Rendering         │   │
│  │                     │  │Optimization         │  │Optimization         │   │
│  │ • JPEG Compression  │  │ • Connection Pool   │  │ • Async Updates     │   │
│  │ • Size Optimization │  │ • Request Batching  │  │ • Canvas Caching    │   │
│  │ • Format Conversion │  │ • Retry Logic       │  │ • Smooth Animation  │   │
│  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘   │
│                                                                             │
│  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐   │
│  │Memory Management    │  │Threading            │  │Caching Strategy     │   │
│  │                     │  │                     │  │                     │   │
│  │ • Bitmap Recycling  │  │ • Background Tasks  │  │ • Result Caching    │   │
│  │ • Memory Monitoring │  │ • Main Thread UI    │  │ • Image Caching     │   │
│  │ • Garbage Collection│  │ • Coroutine Usage   │  │ • Config Caching    │   │
│  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

이 아키텍처 다이어그램은 AlcoLook 앱의 전체 구조를 보여줍니다:

- **계층화된 아키텍처** (Presentation → Business → Data)
- **AWS 클라우드 서비스** 연동
- **보안 및 성능** 최적화
- **모듈 간 의존성** 관계
- **데이터 플로우** 및 **컴포넌트 상호작용**

각 레이어가 명확히 분리되어 있어 유지보수성과 확장성이 뛰어난 구조입니다!
