# AlcoLook PRD (Product Requirements Document)

## 제품 개요

**AlcoLook**은 온디바이스 로컬 처리를 원칙으로 하는 음주 기록 및 얼굴 기반 재미형 음주 인식 Android 앱입니다. 사용자가 자신의 음주 습관을 가볍게 점검하고 기록할 수 있도록 돕는 참고용 도구입니다.

### 핵심 가치 제안
- **완전한 프라이버시**: 모든 데이터 처리 및 저장이 디바이스 내에서만 이루어짐
- **간편한 기록**: 캘린더 기반의 직관적인 음주 기록 관리
- **재미있는 분석**: 얼굴 사진을 통한 음주 확률 추정 (참고용)
- **건강한 습관**: 표준잔수 기반 목표 설정 및 트렌드 분석

### 면책 고지
**⚠️ 중요: 본 결과는 참고용이며, 운전 가능 여부 판단에 사용 금지. 의료기기/BAC 대체 아님.**

---

## 참고 서비스 분석

| 서비스 | 참고 요소 | 차별화 포인트 |
|--------|-----------|---------------|
| **MyFitnessPal** | 캘린더 기반 기록 UI, 목표 설정 | 음주 전용 특화, 얼굴 분석 추가 |
| **Daylio** | 간단한 일일 기록, 통계 시각화 | 표준잔수 계산, 건강 지수 표시 |
| **Forest** | 캐릭터 기반 동기부여 | 음주 관련 캐릭터 코멘트 |
| **삼성 헬스** | 로컬 데이터 저장, 프라이버시 | 완전 오프라인, 네트워크 연결 불필요 |

### 차별화 전략
1. **완전한 오프라인 동작**: 네트워크 연결 없이 모든 기능 사용 가능
2. **얼굴 기반 재미 요소**: ML Kit을 활용한 음주 확률 추정
3. **표준잔수 기반 과학적 접근**: WHO 기준 표준잔수 계산 및 건강 지수 제공

---

## 핵심 기능 및 명세

### 1. 정보 구조 (IA)

```
AlcoLook
├── 홈 (촬영) 탭
│   ├── 카메라 프리뷰
│   ├── 촬영 버튼
│   └── 결과 화면
├── 캘린더 탭
│   ├── 월별 하위탭
│   │   ├── 월 그리드 뷰
│   │   ├── 날짜별 상태 표시
│   │   └── 선택일 기록 리스트
│   └── 통계 하위탭
│       ├── 주간/월간 토글
│       ├── 건강 지수 카드
│       ├── 트렌드 차트
│       └── 종류별 통계
└── 설정 탭
    ├── 프로필 설정
    ├── 목표 설정
    └── 데이터 관리
```

### 2. 기능별 상세 명세

#### 2.1 홈 (얼굴 분석)

| 기능 | 명세 | 기술 구현 |
|------|------|-----------|
| **카메라 촬영** | 전면 카메라로 단일 얼굴 사진 촬영 | CameraX v1.4.x |
| **얼굴 검출** | ML Kit으로 얼굴 특징점 추출 | ML Kit Face Detection |
| **음주 확률 계산** | IntoxicationPredictor 인터페이스 | 더미/룰 기반 구현 |
| **결과 표시** | 확률%, 캐릭터 코멘트, 면책 고지 | Jetpack Compose |
| **액션 버튼** | [공유] [결과 기록] [다시] 순서 | Material 3 Button |

**에러 처리:**
- 얼굴 미검출 시: "얼굴이 잘 보이도록 다시 촬영해주세요"
- 다중 인물 시: 가장 큰 얼굴 자동 선택
- 품질 저하 시: "조명이 밝은 곳에서 다시 촬영해주세요"

#### 2.2 캘린더 - 월별 하위탭

| 기능 | 명세 | UI 구현 |
|------|------|---------|
| **월 그리드** | 7x6 캘린더 그리드 표시 | LazyVerticalGrid |
| **날짜 상태** | 양호(기본)/주의(연주황)/폭음(연적색) | 배경색 또는 도트 |
| **기록 CRUD** | 생성/조회/수정/삭제 + Undo | Room + ViewModel |
| **요약 바텀시트** | 선택일 총 섭취량, 표준잔수, 상태 | ModalBottomSheet |

**상태 분류 규칙:**
- **양호**: ≤2 표준잔
- **주의**: 3-5 표준잔 (연주황 #FFF4E5)
- **폭음**: >5 표준잔 (연적색 #FDEBEC)

#### 2.3 캘린더 - 통계 하위탭

| 구성 요소 | 내용 | 구현 방식 |
|-----------|------|-----------|
| **주간/월간 토글** | 기간 선택 스위치 | SegmentedButton |
| **건강 지수 카드** | 상태 배지 + 진행률 표시 | LinearProgressIndicator |
| **캐릭터 코멘트** | 상태별 1-2문장 조언 | Card + Text |
| **주별 트렌드** | 막대 차트 (표준잔수) | Canvas + Box |
| **종류별 통계** | 술 종류별 비율 | 바 차트 + Chip |
| **얼굴 분석 결과** | 분석 데이터 있을 때만 표시 | 조건부 Card |

#### 2.4 설정

| 설정 항목 | 기능 | 구현 |
|-----------|------|------|
| **프로필** | 성별, 연령대(65세 이상 여부) | Preference |
| **주간 목표** | 7/14/21 표준잔 선택 | RadioButton |
| **데이터 관리** | 전체 삭제, 내보내기(옵션) | AlertDialog |
| **도움말** | 사용법, 면책 고지 | 별도 화면 |

### 3. 데이터 모델

#### 3.1 Room 엔티티

```kotlin
// DrinkType enum
enum class DrinkType {
    BEER, SOJU, WINE, WHISKY, HIGHBALL, COCKTAIL, MAKGEOLLI, OTHER
}

// DrinkRecord entity
@Entity(tableName = "drink_records")
data class DrinkRecord(
    @PrimaryKey(autoGenerate = true)
    val id: Long = 0,
    val date: LocalDate,
    val type: DrinkType,
    val abv: Float?, // 도수 (%)
    val volumeMl: Int?, // 용량 (ml)
    val count: Int, // 잔 수
    val note: String?, // 메모
    val analysisProb: Float? // 얼굴 분석 확률
)

// UserProfile entity
@Entity(tableName = "user_profile")
data class UserProfile(
    @PrimaryKey val id: Int = 1,
    val sex: Sex = Sex.UNSET,
    val isSenior65: Boolean = false,
    val weeklyGoalStdDrinks: Int? = null
)

enum class Sex { MALE, FEMALE, UNSET }
```

#### 3.2 계산 로직

**표준잔수 계산:**
```
EtOH(g) = volume_ml × abv_% × 0.789
std_drinks = EtOH / 14
```

**일일 상태 계산:**
- 양호: ≤2 표준잔
- 주의: 3-5 표준잔  
- 폭음: >5 표준잔

---

## 추가 기능 제안

### Phase 2 기능
1. **위젯 지원**: 홈 화면에서 빠른 기록 입력
2. **알림 설정**: 기록 리마인더 (로컬 알림만)
3. **테마 확장**: 다크 모드 완전 지원
4. **접근성 강화**: TalkBack, 큰 글씨 지원

### Phase 3 기능
1. **데이터 내보내기**: CSV/JSON 형태로 백업
2. **고급 통계**: 요일별, 계절별 패턴 분석
3. **목표 달성 배지**: 스트릭, 마일스톤 시스템

---

## 사용자 페르소나 및 시나리오

### 주요 페르소나

#### 페르소나 1: 김민수 (28세, 직장인)
- **특성**: 주 2-3회 회식, 자신의 주량 궁금
- **목표**: 건강한 음주 습관 유지
- **사용 시나리오**: 
  1. 회식 후 얼굴 분석으로 재미있게 확인
  2. 주간 목표 대비 현재 상태 체크
  3. 월말 통계로 한 달 음주 패턴 리뷰

#### 페르소나 2: 이지영 (32세, 프리랜서)
- **특성**: 집에서 가끔 와인, 기록 습관 선호
- **목표**: 음주량 시각화 및 절제
- **사용 시나리오**:
  1. 와인 한 잔 후 간단히 기록
  2. 캘린더에서 월별 패턴 확인
  3. 캐릭터 코멘트로 동기부여 받기

### 핵심 사용자 여정

```
1. 앱 설치 → 프로필 설정 → 주간 목표 설정
2. 음주 후 → 얼굴 촬영 → 결과 확인 → [결과 기록] 선택
3. 기록 화면 → 술 종류/도수/양 입력 → 저장
4. 캘린더에서 → 날짜별 상태 확인 → 통계 탭에서 트렌드 분석
5. 주간 목표 달성도 확인 → 다음 주 목표 조정
```

---

## 기술 스택 권장사항

### 필수 기술 스택

| 영역 | 기술 | 버전 | 근거 |
|------|------|------|------|
| **언어** | Kotlin | Latest | Android 공식 권장 언어 |
| **UI** | Jetpack Compose | Latest | Material 3 지원, 선언적 UI |
| **카메라** | CameraX | v1.4.x | 안정적인 카메라 API |
| **ML** | ML Kit Face Detection | Latest | 온디바이스 얼굴 검출 |
| **DB** | Room | Latest | 로컬 데이터베이스 표준 |
| **DI** | Hilt | Latest | 의존성 주입 표준 |
| **아키텍처** | MVVM + Repository | - | Android 권장 패턴 |

### 프로젝트 구조

```
app/
├── src/main/kotlin/com/alcolook/
│   ├── ui/
│   │   ├── home/          # 홈(촬영) 화면
│   │   ├── calendar/      # 캘린더 화면
│   │   ├── settings/      # 설정 화면
│   │   └── theme/         # 테마, 색상 토큰
│   ├── data/
│   │   ├── local/         # Room 엔티티, DAO
│   │   ├── repository/    # 리포지토리 구현
│   │   └── model/         # 데이터 모델
│   ├── domain/
│   │   ├── usecase/       # 비즈니스 로직
│   │   └── repository/    # 리포지토리 인터페이스
│   └── di/                # Hilt 모듈
└── src/main/res/
    ├── values/
    │   ├── strings.xml    # 한국어 텍스트
    │   ├── colors.xml     # 색상 토큰
    │   └── themes.xml     # Material 3 테마
    └── drawable/          # 아이콘, 이미지
```

### 성능 및 품질 기준

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| **촬영→결과 전환** | < 500ms | 더미 분석 기준 |
| **프레임 드랍** | < 5% | GPU 프로파일러 |
| **앱 크기** | < 50MB | APK 분석기 |
| **메모리 사용** | < 200MB | 메모리 프로파일러 |
| **배터리 효율** | 백그라운드 0% | 배터리 히스토리안 |

---

## 개발 마일스톤

### M0: 기본 구조
- [x] 3탭 네비게이션 구현
- [x] Material 3 테마 적용
- [x] 캘린더 하위탭 (월별/통계) 전환
- [x] 색상 토큰 (#FFF4E5, #FDEBEC) 반영

### M1 틀/UI 구축
- [ ] Figma Dev Mode MCP 및 스크린샷 기반 UI 구축
- [ ] 설정 화면 완성

### M2: 캘린더 기능
- [ ] Room 데이터베이스 구축
- [ ] 기록 CRUD + Undo 기능
- [ ] 월별 캘린더 그리드 + 상태 표시
- [ ] 선택일 요약 바텀시트
- [ ] 표준잔수 계산 로직

### M3: 통계 기능
- [ ] 주간/월간 토글 구현
- [ ] Compose 기반 차트 (막대/바)
- [ ] 건강 지수 카드
- [ ] 캐릭터 코멘트 시스템
- [ ] 얼굴 분석 결과 카드

### M4: 얼굴 분석
- [ ] CameraX 촬영 구현
- [ ] ML Kit 얼굴 검출
- [ ] IntoxicationPredictor 인터페이스
- [ ] 더미 분석 로직
- [ ] 결과 화면 + [결과 기록] 연동

### M5: 마무리
- [ ] 에러 처리 및 빈 상태 UI
- [ ] 접근성 개선
- [ ] 성능 최적화
- [ ] 최종 테스트

---

## 규정 준수 및 보안

### 프라이버시 원칙
1. **완전한 로컬 처리**: 모든 데이터가 디바이스를 벗어나지 않음
2. **최소 권한**: 카메라 권한만 요청 (INTERNET 권한 금지)
3. **사용자 제어**: 언제든 전체 데이터 삭제 가능
4. **투명성**: 데이터 처리 방식 명시

### 법적 고지사항
- **의료기기 아님**: 의료 목적 사용 금지 명시
- **운전 판단 금지**: BAC 대체 불가 경고
- **참고용 도구**: 엔터테인먼트 목적 강조
- **책임 제한**: 결과에 대한 법적 책임 없음

### 접근성 준수
- **WCAG 2.1 AA**: 색상 대비 4.5:1 이상
- **터치 타깃**: 최소 44dp 크기
- **스크린 리더**: 모든 UI 요소에 contentDescription
- **키보드 네비게이션**: 포커스 순서 논리적 구성

---

## 결론

AlcoLook은 완전한 프라이버시 보호 하에 사용자의 음주 습관을 재미있고 과학적으로 관리할 수 있는 혁신적인 앱입니다. 얼굴 기반 분석이라는 독특한 재미 요소와 표준잔수 기반의 건강 관리를 결합하여, 20-30대 사용자들에게 새로운 가치를 제공할 것입니다.

**핵심 성공 요인:**
1. **완벽한 오프라인 동작**으로 프라이버시 우려 해소
2. **직관적인 캘린더 UI**로 지속적인 사용 유도  
3. **과학적 표준잔수 계산**으로 신뢰성 확보
4. **재미있는 얼굴 분석**으로 차별화된 경험 제공

이 PRD를 바탕으로 단계적 개발을 진행하여 사용자에게 가치 있는 음주 관리 도구를 제공하겠습니다.